# 4.1 데이터베이스의 기본

- 데이터베이스(DB, DataBase): 일정한 규칙, 혹은 규약을 통해 구조화되어 저장되는 데이터의 모음
- DBMS: 데이터베이스를 제어, 관리하는 통합 시스템

## 4.1.1 엔터티

- 엔터티(entity): 사람, 장소, 물건, 사건, 개념 등 여러 개의 속성을 지닌 명사를 의미
- ex. '회원'이라는 엔터티가 있을 때 이 회원은 이름, 아이디, 주소, 전화번호 등의 속성을 가진다.

### 약한 엔터티와 강한 엔터티

- 약한 엔터티: 혼자서는 존재하지 못하고 다른 엔터티의 존재 여부에 따라 종속적인 엔터티
- 강한 엔터티: 다른 엔터티에 의존하지 않고 독립적으로 존재할 수 있는 엔터티

## 4.1.2 릴레이션

- 릴레이션(relation): 데이터베이스에서 정보를 구분하여 저장하는 기본 단위
- 엔터티에 관한 데이터를 릴레이션 하나에 담아 관리

<img width="500" src="https://github.com/user-attachments/assets/2e2dbdb3-61c3-428c-8388-c339ec2ce9f4"/>

- 그림에서처럼 회원이라는 엔터티는 데이터베이스에서 관리될 때 릴레이션으로 변화된다.
- 릴레이션은 관계형 데이터베이스에서는 **테이블**이라 하며, NoSQL 데이터베이스에서는 **컬렉션**이라 한다.

### 테이블과 컬렉션

- 데이터베이스의 종류는 크게 1. 관계형 데이터베이스(MYSQL이 대표적) 2. NoSQL 데이터베이스(MongoDB가 대표적)로 구분 가능
- MySQL의 구조는 레코드-테이블-데이터베이스로 이루어져 있다.
- MongoDB 데이터베이스 구조는 도큐먼트-컬렉션-데이터베이스로 이루어져 있다.

## 4.1.3 속성

- 속성(attribute): 릴레이션이 관리하는 구체적이며 고유한 이름을 갖는 정보
- ex. '차'라는 엔터티가 있을 때 속성은 차 번호, 바퀴 수, 차종 등 많은 것이 있지만 이 중 서비스의 요구 사항을 기반으로 관리해야 할 필요가 있는 속성들만 엔터티의 속성이 된다.

## 4.1.4 도메인

- 도메인(domain): 릴레이션에 포함된 각각의 속성들이 가질 수 있는 값의 집합
- ex. '성별'이라는 속성이 있을 때 이 속성이 가질 수 있는 값은 (남, 여)라는 집합이 된다.

## 4.1.5 필드와 레코드

앞에서 설명한 엔터티, 속성, 도메인 등을 기반으로 데이터베이스에서 필드와 레코드로 구성된 테이블을 만들 수 있다.

<img width="600" src="https://github.com/user-attachments/assets/df107b69-57a3-4b0d-8cc8-9a29280e0f82" />

- 회원(엔터티) -> member(테이블)
- 이름, 아이디 등(속성) -> name, ID 등(필드)
- 레코드: 테이블에 쌓이는 행(row) 단위의 데이터. 튜플이라고도 한다.

### 필드 타입

- 필드는 타입을 가지며, 대표적인 타입은 숫자, 날짜, 문자가 있다.
- DBMS마다 타입이 다르며, 책에서는 MySQL을 기준으로 설명

**숫자 타입**

- TINYINT, SMALLINT, MEDIUMINT, INT, BIGINT 등

<img width="850" src="https://github.com/user-attachments/assets/2aa8dacb-dfa2-4ed6-b8ea-a9d70063961b" />

**날짜 타입**

- DATE, DATETIME, TIMESTAMP 등
- DATE: 날짜 부분은 있지만 시간 부분은 없는 값에 사용, 지원 범위는 1000-01-01~9999-12-31, 3바이트의 용량을 가진다.
- DATETIME: 날짜 및 시간 부분을 모두 포함하는 값에 사용, 지원 범위는 1000-01-01 00:00:00~9999-12-31 23:59:59, 8바이트의 용량을 가진다.
- TIMESTAMP: 날짜 및 시간 부분을 모두 포함하는 값에 사용, 지원 범위는 1970-01-01 00:00:01~2038-01-19 03:14:07, 4바이트의 용량을 가진다.

**문자 타입**

- CHAR와 VARCHAR: 수를 입력하며 몇 자까지 입력할지 정한다. CHAR(30)이라면 최대 30글자

  - CHAR: 테이블을 생성할 때 선언한 길이로 고정, 길이는 0~255. 레코드를 저장할 때 무조건 선언한 길이 값으로 '고정'해서 저장된다.
  - VARCHAR: 가변 길이 문자열, 길이는 0~65,535. 입력된 데이터에 따라 용량을 가변시켜 저장한다.
    - VARCHAR(10000)으로 선언했더라도 10글자를 저장할 경우 10글자에 해당하는 바이트 + 길이기록용 1바이트로 저장하게 된다.

- TEXT와 BLOB: 큰 데이터를 저장할 때 쓰는 타입

  - TEXT: 큰 문자열 저장에 사용, 주로 게시판의 본문을 저장할 때 사용한다.
  - BLOB: 이미지, 동영상 등 큰 데이터 저장에 사용. 그러나 보통은 AWS의 S3을 이용하는 등 서버에 파일을 올리고 파일에 관한 경로를 VARCHAR로 저장한다.

- ENUM과 SET: 문자열을 열거한 타입
  - ENUM: ENUM('x-small', 'small', 'medium', 'large', 'x-large') 형태로 쓰임. 이 중 하나만 선택하여 사용, 잘못된 값을 삽입하면 빈 문자열이 대신 삽입. x-small 등이 0, 1 등으로 매핑되어 메모리를 적게 사용할 수 있으며 최대 65,535의 요소들을 넣을 수 있다.
  - SET: ENUM과 비슷하지만, 여러 개의 데이터를 선택 가능하고 비트 단위 연산을 할 수 있으며 최대 64개의 요소를 넣을 수 있다.
  - 이 두 개는 공간적으로 이점은 있으나 애플리케이션 수정에 따라 데이터베이스의 ENUM, SET에서 정의한 목록을 수정해야 한다는 단점이 있다.

## 4.1.6 관계

데이터베이스 테이블은 하나만 있는게 아니라 여러 개가 존재하고 이들은 서로 관계가 정의되어 있다.
이러한 관계를 관계 화살표로 나타낸다.

<img width="660" src="https://github.com/user-attachments/assets/ebbceec4-d9ed-4ed2-8467-5ea3f76120cc" />

### 1:1 관계

- 1:1 관계는 테이블을 두 개의 테이블로 나눠 테이블의 구조를 더 이해하기 쉽게 만들어 준다.

### 1:N 관계

- 한 개체가 다른 많은 개체를 포함하는 관계를 말한다.
- 예를 들어 쇼핑몰을 운영한다고 할 때, 한 유저당 여러 개의 상품을 장바구니에 넣을 수 있다. 물론 하나도 넣지 않는 0개의 경우도 있으니 0도 포함되는 화살표를 통해 표현해야 한다.


### N:M 관계

- 학생도 강의를 많이 들을 수 있고 강의도 여러 명의 학생을 포함할 수 있다.
- 아래 그림에서 중간에 학생\_강의라는 테이블이 있는데, N:M은 테이블 두 개를 직접적으로 연결해서 구축하지 않고 1:N, 1:M 이라는 관계를 갖는 테이블 두 개로 나눠서 설정한다.
  
  <img width="440" src="https://github.com/user-attachments/assets/74119acb-fd30-4dc6-a8eb-879d8287730a">

## 4.1.7 키

- 테이블 간의 관계를 조금 더 명확하게 하고 테이블 자체의 인덱스를 위해 설정된 장치
- 기본키, 외래키, 후보키, 슈퍼키, 대체키가 있다.

<img width="400" src="https://github.com/user-attachments/assets/23aa3bbe-f3b7-49c1-b23a-b203e9633c35" />

- 유일성: 중복되는 값이 없다.
- 최소성: 필드를 조합하지 않고 최소 필드만 써서 키를 형성할 수 있는 것을 말한다.
  - ex. 누군가를 식별하기 위해 이름과 전화번호를 쓸 수 있지만, 전화번호만으로도 그 사람을 유일하게 식별할 수 있다. 이 경우 전화번호만 사용하는 것이 최소키

### 기본키

- 기본키(Primary Key): PK라고도 하며, 유일성과 최소성을 만족하는 키
- 테이블의 데이터 중 고유하게 존재하는 속성이며 중복이 될 수 없다.
- 기본키는 자연키 또는 인조키 중에 골라 설정한다.
  - 자연키: 이미 존재하는 고유한 값을 사용하는 것 (주민등록번호)
  - 인조키: 새롭게 고유 ID를 만들어 사용하는 것. 변경될 가능성이 적고 관리가 용이함.

### 외래키

- 외래키(Foreign Key): FK라고도 하며, 다른 테이블의 기본키를 그대로 참조하는 값
- 개체와의 관계를 식별하는 데 사용
- 외래키는 중복될 수 있다.

<img width="530" src="https://github.com/user-attachments/assets/71500f57-d279-4d4b-b7a2-b178a0115c7b" />

### 후보키

- 후보키(candidate key): 기본키가 될 수 있는 후보들이며 유일성과 최소성을 동시에 만족하는 키

### 대체키

- 대체키(alternate key): 후보키가 두 개 이상일 경우 어느 하나를 기본키로 지정하고 남은 후보키들을 말한다.

### 슈퍼키

- 슈퍼키(super key): 각 레코드를 유일하게 식별할 수 있는 유일성을 갖춘 키
